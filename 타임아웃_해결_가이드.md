# 타임아웃 문제 해결 가이드

## 🔍 문제 진단

로그를 확인한 결과:
- **문제**: IMF API 호출이 20초 후 타임아웃 발생
- **원인**: IMF API가 응답하는 데 20초 이상 걸림
- **해결**: Background Functions 사용 + 타임아웃 증가

## ✅ 적용된 해결책

### 1. Background Functions로 변경
- 파일명: `imf-api-background.js` (이름에 `-background` 포함)
- **장점**: 최대 15분까지 실행 가능 (일반 Functions는 10초 제한)
- **타임아웃**: 60초로 증가

### 2. 클라이언트 타임아웃 증가
- 브라우저에서 70초까지 대기
- Background Functions는 더 오래 걸릴 수 있음

## 📋 변경사항

### 수정된 파일:
1. `netlify/functions/imf-api-background.js` - Background Function으로 변경
2. `index.html` - 함수 경로 및 타임아웃 수정

### 변경 내용:
- 함수 경로: `/.netlify/functions/imf-api` → `/.netlify/functions/imf-api-background`
- 서버 타임아웃: 20초 → 60초
- 클라이언트 타임아웃: 30초 → 70초

## 🚀 배포 후 확인사항

### 1. Functions 확인
Netlify 대시보드에서:
- Functions 탭 → `imf-api-background` 함수 확인
- Background Functions는 별도로 표시됨

### 2. 로그 확인
- Functions → `imf-api-background` → Logs
- 타임아웃이 60초로 증가했는지 확인
- IMF API 응답이 오는지 확인

### 3. 테스트
- 사이트에서 "데이터 불러오기" 클릭
- 70초까지 대기 (Background Functions는 첫 실행 시 더 느릴 수 있음)

## ⚠️ 여전히 타임아웃이 발생한다면

### 대안 1: Node.js https 모듈 사용
이미 `imf-api-alt.js` 파일이 준비되어 있습니다:

1. `index.html`에서 함수 경로 변경:
   ```javascript
   const functionUrl = `/.netlify/functions/imf-api-alt?...`;
   ```

2. GitHub에 푸시하고 재배포

### 대안 2: IMF API URL 확인
IMF API가 실제로 작동하는지 확인:

브라우저에서 직접 테스트:
```
https://www.imf.org/external/datamapper/api/v1/LUR/KR?periods=2015-2024
```

### 대안 3: 다른 데이터 소스 사용
IMF API가 불안정하다면:
- 다른 경제 데이터 API 사용
- 또는 샘플 데이터로 데모 제공

## 📝 다음 단계

1. **변경사항 업로드**:
   ```powershell
   git add .
   git commit -m "Switch to Background Functions to fix timeout issue"
   git push
   ```

2. **Netlify 재배포 대기**
   - 자동으로 재배포됨
   - 배포 완료까지 1-2분 소요

3. **테스트**
   - 사이트에서 데이터 불러오기 테스트
   - 로그에서 타임아웃이 해결되었는지 확인

## 🆘 문제가 계속되면

로그에서 다음을 확인하세요:
- 타임아웃 시간이 60초로 증가했는지
- IMF API가 실제로 응답하는지
- 다른 오류 메시지가 있는지

로그 정보를 알려주시면 추가로 도와드리겠습니다!



